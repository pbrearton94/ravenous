(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[431],{"+gav":function(e,t,s){"use strict";var r=s("hhPA"),o=s.n(r),n=s("+gt8");const i={name:"AdapterStore",init(){this._adapter=null,this._broadcast=null,this.listenToMany({onBroadcast:n.a.broadcast,onNewAdapter:n.a.newAdapter})},onBroadcast(...e){!this._adapter||!this._broadcast||e.length<1||this._broadcast(...e)},onNewAdapter(e){this._adapter=e,this._broadcast=e.createComponentBroadcastFunction("Reflux"),this.trigger()}};o.a.createStore(i)},"+gt8":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("hhPA");const o=s.n(r).a.createActions(["broadcast","newAdapter"])},"21f3":function(e,t,s){"use strict";s.d(t,"a",(function(){return PlatformHeader}));var r=s("q1tI"),o=s.n(r),n=s("/MKj"),i=s("SAJr"),a=s("VJ3r"),l=s("BzM2"),c=s("fhzG"),h=s.n(c),d=s("ydTQ"),p=s("jO1x");const u=h()({displayName:"WorkspaceStatus",mixins:[l.a.connect(d.a,"workspaceStatusType"),l.a.connect(d.a,"workspaceStatusMessage")],render(){return o.a.createElement(p.a,{message:this.state.workspaceStatusMessage,mode:this.state.workspaceStatusType})}});var g=s("yy36");const PlatformHeader=({prerender:e,setProgressToCurrentExercise:t,walkthroughVideoUrl:s,workspace:r})=>{const l=Object(n.useSelector)(g.s)?o.a.createElement(i.a,{setProgressToCurrentExercise:t,prerender:e,currentWorkspace:r}):null;return o.a.createElement(a.b,{showTools:!0,adminTab:l,statusDisplay:o.a.createElement(u,null),walkthroughVideoUrl:s})}},"F6+0":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("hhPA");const o=s.n(r).a.createActions(["resized","resizing","cueSeen"])},"Fd/6":function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var r=s("rePB"),o=s("zdiy"),n=s.n(o);const i=s("dLBa").a.extend({initialize(){},createComponentBroadcastFunction(e){return function(){const t=arguments[0],s=["component",e,t].join(":"),r=Array.prototype.slice.call(arguments,1),o=[s].concat(r);this.trigger.apply(this,o)}.bind(this)},_handle(e){this._handlers[e].forEach((e=>{e.call(this)}))},registerComponent(e,t){this._components[e]=t},destroy(){this._handle("destroy");for(const e in this._events)this.off(e)},inheritCache(e){this._cache=e._cache},extendCache(){this._handle("extendCache")}});function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function CommunicationAdapter(e){return function(){const t=function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({mixins:[]},e);let s={};const o=t.mixins,a=[t.events],l={destroy:[],extendCache:[]};function keepHandler(e,t){void 0!==e[t]&&(l[t].push(e[t]),delete e[t])}delete t.events,keepHandler(t,"destroy"),keepHandler(t,"extendCache"),s=n()(s,t),void 0!==o&&o.forEach((e=>{keepHandler(e,"destroy"),keepHandler(e,"extendCache"),a.push(n()({},e.events)),delete e.events,s=n()(s,e)}));const c=new(i.extend(s));return c._handlers=l,c._components={},c._state={},c._cache={},a.forEach((e=>{for(const t in e)c.on(t,e[t].bind(c))})),c}}var a=s("NZ0w"),l={events:{"interface:persist":function(){a.a.persist()},"component:Brief:start":function(){this.controller.revealComponents()}}},c=s("ydTQ");const h={PersistentCodeEditor:[{events:{"component:PersistentCodeEditor:error":function(e){this.controller.setState({errors:e})}}}],OutputTerminal:[{}],Terminal:[{events:{"component:Terminal:input":function(e,t){c.a.interface.execute(e).then((s=>{t(e,s.Content,s.Error?1:0)})).catch((()=>{t(e,"",1)}))}}}],WebBrowser:[],Brief:[l]},d={forComponents(e){return CommunicationAdapter({mixins:this._getBaseMixins(e)})()},forProjectsWithComponents(e){return CommunicationAdapter({mixins:this._getBaseMixins(e)})()},_getComponentMixins(e,t){const s=Object.keys(e);let r=[];return s.forEach((e=>{e in t&&(r=r.concat(t[e]))})),r},_getBaseMixins(e){return this._getComponentMixins(e,h)}}},GDib:function(e,t,s){"use strict";var r=s("rePB"),o=s("gLAU"),n=s.n(o),i=s("zdiy"),a=s.n(i),l=s("mwIZ"),c=s.n(l),h=s("7tbW"),d=s.n(h),p=s("gZmR"),u=s("TSYQ"),g=s.n(u),m=s("fhzG"),f=s.n(m),b=s("q1tI"),w=s.n(b),y=s("i8i4"),v=s.n(y),C=s("/MKj"),E=s("z9go"),k=s("F6+0"),O=s("NZ0w");const FullScreenControls=({isFullscreen:e,toggleFullscreen:t})=>{const s=e?"minimize":"fullscreen";return w.a.createElement("div",{"data-cue":"discovery-fullscreen",className:"fcn-control fcn-control--right",onClick:t},w.a.createElement("span",{className:`fcn-icon fcn-icon-${s}`}))};var S=s("OOdZ"),T=(s("u2tZ"),s("QtoC")),_=s("Wdql"),x=s("CWAm"),j=s("BzM2"),B=s("FZcb"),P=s("1Wj3"),N=s("ZK4f"),R=s("hhPA"),M=s.n(R),D=s("C5ZO"),F=s("uBVh"),W=s("swBZ"),L=s("yole"),A=s("FmSy"),I=s("PpPx"),z=s("DZdY"),U=s("oHca"),K=s("ATyU"),G=s("qqJs"),H="codeFooterButton__EBaDNNWQLtjTzNWBwrVVY";const V=Object(z.a)(U.a,{target:"e144o6f90",label:"StyledToolTip"})({name:"g2aenb",styles:"z-index:9"}),CodeFooterButton=({ariaLabel:e,children:t,id:s,onClick:r,tooltipText:o})=>w.a.createElement(K.a.div,{animate:{opacity:1,marginTop:"0px"},initial:{opacity:0,marginTop:"30px"},transition:{duration:.5}},w.a.createElement(V,{id:s,mode:"dark",target:w.a.createElement("div",{className:H},w.a.createElement(G.a,{ariaLabel:e,theme:"editor",isControl:!0,clickHandler:r,testId:`${s}-button`},t))},o));var Z="copyMessage__2pQWQgwBHErvpTsZkiTzpz",$="error__2Vp9gpr0ou0Oabaq4RUS6n";class CopyContentControl_CopyContentControl extends b.Component{constructor(...e){super(...e),Object(r.a)(this,"state",{message:"",error:!1}),Object(r.a)(this,"copyFile",(async()=>{const e=this.props,t=e.content,s=e.successMessage,r=e.failMessage;(0,e.trackClick)({data:{target:"copy_file"}});try{await navigator.clipboard.writeText(t),this.setState({message:s,error:!1})}catch{this.setState({message:r,error:!0})}}))}componentDidUpdate(e){const t=this.props.content;e.content!==t&&this.setState({message:"",error:!1})}render(){const e=this.state,t=e.message,s=e.error,r="Copy to Clipboard";return w.a.createElement(CodeFooterButton,{ariaLabel:r,id:"copy",onClick:this.copyFile,tooltipText:r},w.a.createElement(I.a,{"data-testid":"copy-content-control"}),t&&w.a.createElement("span",{"aria-live":"polite",className:g()(Z,s&&$),"data-testid":"copy-content-control-message"+(s?"-error":"")},t))}}Object(r.a)(CopyContentControl_CopyContentControl,"defaultProps",{content:"",successMessage:"File copied!",failMessage:"There was a problem."});var Q=s("D5Q1"),q=s("4Te6"),Y=s("ydTQ");function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const createDirectories=(e,t)=>O.a.createDirectories(e,_objectSpread({overwriteExisting:!1},t)),updateFiles=(e,t)=>O.a.updateFiles(e,_objectSpread({overwriteExisting:!1},t)),deleteFile=e=>O.a.deleteFile(e).then(O.a.updateFileTree),openFile=e=>{const t=F.a(F.b(e));O.a.getFile(e,t).then((()=>{L.a.openFile(q.a.emptyWithPath(e))}))},renameFile=(e,t)=>O.a.rename(e,t,{overwriteExisting:!1});var J=Object(j.b)(Y.a,["workspaceDirectory"])((({open:e,workspaceDirectory:t,toggleLayout:s})=>(Object(b.useEffect)((()=>{e&&O.a.getFileTree()}),[e]),w.a.createElement(Q.a,{open:e,directory:t,createDirectories:createDirectories,updateFiles:updateFiles,deleteFile:deleteFile,openFile:openFile,renameFile:renameFile,toggleLayout:s})))),X=s("KKCq"),ee=s("2oex"),te=s("wx14"),se=s("Ff2n"),re="button__8RgBAq12E71O1XuArYhoJ";const oe=["children"],HelpButton=e=>{const t=e.children,s=Object(se.a)(e,oe);return w.a.createElement(B.a,Object(te.a)({},s,{flat:!0,theme:"white",target:"_blank",className:re,"data-testid":"view-solution-button"}),t)},ne={userClick:x.f,userImpression:x.g};var ie=Object(C.connect)((e=>({reviewLink:Object(ee.D)(e)})),ne)((e=>{const t=e.reviewLink,s=e.userClick,r=e.userImpression;Object(b.useEffect)((()=>{r({data:{target:"view_cheatsheet"}})}),[r]);return w.a.createElement(HelpButton,{target:"_blank",href:t,onClick:()=>{s({data:{target:"view_cheatsheet",context:"code_editor"}})}},w.a.createElement(N.a,{size:24,title:"Concept Review",style:{marginRight:"0.3rem"}}),W.components.code_editor.review_button)})),ae=s("4xzQ"),le=s("loBw");const ce={userImpression:x.g};var he=Object(C.connect)(null,ce)((({userImpression:e})=>(Object(b.useEffect)((()=>{e({data:{target:"savepointsSolutionButton"}})}),[e]),w.a.createElement(le.b,{buttonClickTrackingTarget:"savepointsSolutionButton",trackingContext:"solution_button"},(e=>w.a.createElement(HelpButton,{onClick:e},w.a.createElement(ae.a,{size:24,style:{marginRight:"0.3rem"}}),W.components.code_editor.savepoints_button)))))),de="container__3fYOsbzX6XcVJs0aoAXfaV";var pe=Object(C.connect)((e=>({showReviewButton:Object(ee.A)(e),failureCount:Object(_.e)(e)})))((({failureCount:e,showReviewButton:t})=>{const s=t&&1===e?w.a.createElement(ie,null):e>1?w.a.createElement(he,null):null;return w.a.createElement("span",{className:de},s)})),ue=s("z9KF"),ge=s("b+vN"),me=s("t2YD");const fe=M.a.createStore({name:"OrphanedFilesStore",mixins:[j.a.store],init(){this.workspaceSlug=null,Y.a.listen(this.checkWatchedFiles,this),this.listenTo(me.a.publishFilenames,this.setDefaultFiles),this.listenTo(me.a.loadFiles,this.resetOrphanedFiles)},getInitialState:()=>({orphaned:[],watching:[],notify:[]}),setDefaultFiles(e){this.setState({watching:e})},resetOrphanedFiles(){this.watching=[],this.setState({orphaned:[],watching:[]})},checkWatchedFiles(e){if(e.workspaceObject&&e.workspaceReady){const t=[];for(const s of this.state.watching)void 0===e.workspaceObject.getFile(s)&&t.push(s);this.setState({orphaned:t})}}}),be=f()({displayName:"MissingFilesWall",mixins:[j.a.connect(fe,["orphaned"],{onChange:"checkOrphans"})],getInitialState:()=>({phase:"inactive",notify:!0}),checkOrphans(){this.state.orphaned.length||this.setState({phase:"inactive"})},showConfirmation(){this.setState({phase:"confirmation"})},cancelAndClose(){this.setState({notify:!1,phase:"inactive"})},resetFiles(){this.setState({notify:!0,phase:"fixing"}),O.a.restore()},resetFilesContent(){const e=this.state.orphaned[0],t=this.state.notify&&this.state.orphaned.length>0&&"confirmation"!==this.state.phase;return w.a.createElement(ge.a,{isOpen:t,cancel:this.cancelAndClose,action:this.showConfirmation,actionText:"Reset Files",cancelText:"Ok",title:"Whoa there!",subtitle:`${e} has been moved. This will cause problems with this exercise, please move ${e} back to its original location, or reset your files.`})},resetFilesConfirmationContent(){const e=this.state.notify&&this.state.orphaned.length>0&&"confirmation"===this.state.phase;return w.a.createElement(ge.a,{isOpen:e,cancel:this.cancelAndClose,action:this.resetFiles,title:W.components.code_editor.reset_workspace_confirmation_title,subtitle:W.components.code_editor.reset_workspace_confirmation_content})},render(){return w.a.createElement("div",null,"inactive"===this.state.phase?this.resetFilesContent():this.resetFilesConfirmationContent())}});var we=s("dcaa"),ye=s("ev85"),ve=s("PIZE"),Ce=s("kuGx"),Ee=M.a.createStore({name:"InterfaceStore",listenables:[k.a],resized(){this.trigger()},resizing(){this.trigger()}}),ke=s("9IZE"),Oe="runButton__2uQVTMn2N52sHjz-Bz2rI2";const LegacyRunButton=({children:e,disabled:t,hasTyped:s,ariaLabel:r,onClick:o})=>{const n=navigator.platform.match("Mac")?"⌘ + return":"ctrl + enter";return w.a.createElement(U.a,{alignment:"top-right",id:"run",mode:"dark",target:w.a.createElement(B.a,{className:Oe,square:!0,theme:"royalblue",go:!t&&s,disabled:t,onClick:o,"data-testid":"run-button","aria-label":r},e)},n)};var Se=s("kMW1");const ResetWorkspaceButton=({noun:e,onClick:t})=>{const s=`Reset ${e} (${navigator.platform.match("Mac")?"ctrl":"alt"} + g)`;return w.a.createElement(CodeFooterButton,{ariaLabel:s,id:"reset",onClick:t,tooltipText:s},w.a.createElement(Se.a,null))};var Te="edFToolLayoutContainer__1k0ofduspbCuwrugNJKsJd",_e="mainContainer__3f-bTuWfhAnqTEI2uZ3ZWg",xe="layoutCollapsed__3xm5yNjl9Xl7k6RghljlBs",je="fileTabOpen__3RNjkMsg58BD29bMER7hiH",Be="noNavigator__2BCA6PQSwz-zCOMpp-nOa-",Pe="tabsOffSet__2Bt6pWD8KrnHZw8kYuhqyf",Ne="editorContainerPadded__1HINGnQ-Cn2f9BdqehjYlq",Re="editorFooter__3vwk-k2NGitXY-FI-IT16w",Me="codeEditorSkeleton__1_B5WnzvIeZjvSmOntzI4t",De="footerContainer__1z5LFGBvRHKImhrGkUdzEr",Fe="codeEditorPlaceholder__22nBML1M0BkmZEhqwsVArj";const We=f()({displayName:"CodeEditor",mixins:[j.a.connect(Ce.a,["files","active","hasReceivedCurrentFiles"]),j.a.connect(Y.a),M.a.listenTo(Ee,"onResize")],getInitialState(){let e;return this.props.geometry&&(e={width:this.props.geometry.width(),height:this.props.geometry.height()}),{openResetWorkspaceWall:!1,fileToolOpen:!1,hasTyped:!1,collapsed:!0,dimensions:e}},toggleLayout(){this.setState((e=>({collapsed:!e.collapsed,fileToolOpen:!e.fileToolOpen})))},componentDidMount(){window.addEventListener("keydown",this.onKeyDown)},componentWillUnmount(){window.removeEventListener("keydown",this.onKeyDown)},isEvaluateExerciseEvent:e=>13===e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey),isResetExerciseEvent:e=>71===e.keyCode&&(navigator.platform.match("Mac")?e.ctrlKey:e.altKey),onKeyDown(e){if(this.isEvaluateExerciseEvent(e))this.submitClick();else{if(!this.openResetWorkspaceWall||!this.isResetExerciseEvent(e))return!0;this.openResetWorkspaceWall()}return e.preventDefault(),!1},processFiles(){return new Promise((e=>{this.props.presenter.hasCheckWork?O.a.autoSaveFiles().then(e):e()}))},onModelChanged(e){const t=this.state.files[this.state.active];t&&t.content!==e&&(this.setState({persistingFiles:!0}),L.a.updateFile(t,e).then((()=>{this.processFiles().then((()=>{this.setState({persistingFiles:!1})}))})),this.state.hasTyped||this.setState({hasTyped:!0}))},submitClick(){this.state.offerAnswer&&this.props.broadcast("keepTrying"),this.setState({offerAnswer:!1,hasTyped:!1}),this.setState({persistingFiles:!0}),this.props.presenter.evaluateExercise().then((()=>{this.setState({persistingFiles:!1})})).catch((e=>{e&&600===e.code&&this.props.broadcast("error",{visible:!0,timestamp:(new Date).valueOf(),friendly:e.message,component:"PersistentCodeEditor"}),this.setState({persistingFiles:!1})}))},saveWorkspace(e){""!==e&&O.a.saveFilesAndCheckWork().then((()=>O.a.getFetchUrl(e))).then((t=>O.a.persist(t,e)))},updateTree(){this.props.broadcast("getFileTree")},offerAnswer(){this.setState({offerAnswer:!0})},renderHeader(){return this.renderTabs()},renderEditorOrPlaceholder(){return Object(ve.a)(this.state)?w.a.createElement("div",{className:Me},w.a.createElement(ue.a,null)):this.state.files.length>0?this.renderEditor():this.renderPlaceholder()},renderEditor(){return w.a.createElement(D.a,{file:this.activeFile(),onChange:this.onModelChanged})},_ignoreOrphan(){this.setState({hasNewOrphan:!1})},_keepTrying(){this.setState({offerAnswer:!1}),this.props.broadcast("keepTrying")},_showAnswer(){this.setState({offerAnswer:!1}),this.props.broadcast("showAnswer")},openResetWorkspaceWall(){this.props.trackClick({data:{target:"platformResetWorkspaceDialog"}}),this.setState({openResetWorkspaceWall:!0})},closeResetWorkspaceWall(){this.setState({openResetWorkspaceWall:!1})},renderFooter(){const e=this.props.presenter;return w.a.createElement("div",{className:De},e.displayErrors&&w.a.createElement(A.a,null),w.a.createElement(ye.a,null,this.renderFooterButtons()))},renderFooterButtons(){const e=this.props.trackClick,t=this.state.persistingFiles||this.props.checkpointsRunning,s=t||0===this.state.files.length,r=this.props.modifiers.isProject?W.components.code_editor.save:W.components.code_editor.run,o=this.props.modifiers.isProject?W.components.code_editor.save_aria_label:W.components.code_editor.run_aria_label,n=this.props.modifiers.isProject?W.components.code_editor.project:W.components.code_editor.exercise;return w.a.createElement(w.a.Fragment,null,w.a.createElement("div",{className:Re},!this.props.presenter.hasCheckWork&&w.a.createElement(LegacyRunButton,{disabled:s,hasTyped:this.state.hasTyped,onClick:this.submitClick,ariaLabel:o},t?w.a.createElement(X.a,null):r),w.a.createElement(CopyContentControl_CopyContentControl,{trackClick:e,content:this.activeFileContent()}),w.a.createElement(ResetWorkspaceButton,{onClick:this.openResetWorkspaceWall,noun:n}),w.a.createElement(pe,null)),this.props.authoringMode?w.a.createElement(ke.a,{handleSaveWorkspace:this.saveWorkspace,workspaceSlug:Y.a.state.workspaceSlug,generatedWorkspaceSlug:this.props.presenter.generatedWorkspaceSlug}):null)},placeholderTab:()=>w.a.createElement(G.a,{key:"codeEditorTab-empty",theme:"editor",isActive:!0,canClose:!1,clickHandler:()=>{},closeHandler:()=>{}}),tabsData(){const e=[];return Object(ve.a)(this.state)?(e.push(this.placeholderTab()),e):this.state.files&&this.state.files.length>0?(this.state.files.forEach(((t,s)=>{if(t.isDir)return;const r=this.state.active===s,o=t.name.split("/"),n=o[o.length-1],i=t.path;e.push(w.a.createElement(G.a,{title:n,theme:"editor",key:`codeEditorTab-${i}`,isActive:r,tabId:s,canClose:!this.props.presenter.navigator_disabled||this.props.authoringMode,clickHandler:L.a.setCurrentOpenFile,closeHandler:L.a.closeFile}))})),e):e},renderTabs(){const e=this.tabsData(),t=g()({[Pe]:this.state.collapsed});return w.a.createElement("div",{className:t},w.a.createElement(ye.a,{theme:"editor"},e,w.a.createElement(G.a,{ariaLabel:"Toggle fullscreen",theme:"editor",key:"codeEditorTab-fullscreen","data-cue":"discovery-fullscreen",clickHandler:this.props.helpers.toggleFullscreen,canClose:!1,isControl:!0,align:"right"},w.a.createElement(P.a,null))))},renderPlaceholder(){return w.a.createElement("div",{className:Fe},w.a.createElement("div",null,w.a.createElement(N.a,{size:48})),w.a.createElement("div",{style:{marginTop:15}},"Code Editor"),this.state.hasReceivedCurrentFiles&&!this.state.fileToolOpen?w.a.createElement(B.a,{theme:"lantern",style:{marginTop:20},outline:!0,onClick:this.toggleLayout},"Open file"):null)},activeFile(){if(null!==this.state.active)return this.state.files[this.state.active]},activeFileContent(){const e=this.activeFile();return e?e.content:""},reloadFile(e){if(!this.state.files)return;if(this.state.files.map((e=>e.path)).indexOf(e)>-1){const t=F.a(F.b(e));L.a.reloadFile(e,t)}},render(){const e=g()({editor:!0,[xe]:this.state.collapsed,[Be]:this.props.presenter.navigator_disabled,[je]:!this.state.collapsed}),t=g()({[_e]:!0});return w.a.createElement("div",{className:t},w.a.createElement(be,null),w.a.createElement(we.a,{isOpen:this.state.openResetWorkspaceWall,handleClose:this.closeResetWorkspaceWall}),w.a.createElement("div",{className:Te},!this.props.presenter.navigator_disabled||this.state.authoringMode?w.a.createElement(J,{open:this.state.fileToolOpen,toggleLayout:this.toggleLayout}):null,w.a.createElement("div",{className:e},this.renderHeader(),w.a.createElement("div",{className:g()("editor-container",Ne)},this.renderEditorOrPlaceholder()),this.renderFooter())))}}),Le={trackClick:x.f};var Ae,Ie=Object(C.connect)((e=>({checkpointsRunning:Object(_.h)(e),authoringMode:Object(T.b)(e)})),Le,null,{forwardRef:!0})(We),ze=s("babB"),Ue=s("VAEl"),Ke=s("ScvY"),Ge=s("G9Nm"),He=s("YPUT"),Ve=s("ud20"),Ze="container__1jE6C6bjuF6ymn8Jvdmw2R";let $e=Object(j.b)(Ve.a,["stdout","stderr","exitStatus"])(Ae=class SQLPreview extends w.a.Component{render(){const e=this.props,t=e.stdout,s=e.stderr;return w.a.createElement("div",{className:Ze,"data-testid":"interactive-output-component"},w.a.createElement(He.a,{result:t}),w.a.createElement(A.a,{pinnedBottom:!0,componentOnly:!0,componentError:s}))}})||Ae;var Qe=s("dUu8"),qe=s("NZpv"),Ye=s("nYFV"),Je=s("RoNi"),Xe=s("qwsu"),et=s("WFFW"),tt=s("TYUh");function TerminalRefluxContainer_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function TerminalRefluxContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?TerminalRefluxContainer_ownKeys(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):TerminalRefluxContainer_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const st=f()({displayName:"TerminalContainer",mixins:[M.a.listenTo(k.a.resized,"onResize"),M.a.listenTo(O.a.restore.completed,"resetTerminals"),j.a.connect(Y.a,["workspaceReady","workspaceStatusType"]),j.a.connect(Xe.a,["sessions","busy","currentSession","hasCreatedSessionBefore","fontSize","hasFocus"])],componentDidMount(){this.state.workspaceReady?this.createInitialTerminal():this.unsubSetWorkspace=O.a.setWorkspace.completed.listen((()=>this.setState({workspaceReady:!0}))),Qe.a.saveTerminalReference(this)},componentWillUnmount(){this.unsubSetWorkspace&&this.unsubSetWorkspace()},createInitialTerminal(){0===this.state.sessions.length&&qe.a.createSession("bash").then((()=>{this.props.onReady&&this.props.onReady()}))},componentDidUpdate(e,t){t.currentSession!==this.state.currentSession&&this.state.hasFocus&&this.getActiveTerminal()&&n()((()=>{this.getActiveTerminal().focus()})),t.workspaceReady&&!this.state.workspaceReady&&qe.a.closeAllSessions(),!t.workspaceReady&&this.state.workspaceReady&&this.createInitialTerminal()},getActiveTerminal(){const e=Xe.a.currentSession();return e?this.refs[e.id]:null},getAllTerminals(){return this.state.sessions.map((e=>this.refs[e.id]))},onResize(){const e=this.getAllTerminals();if(!e||!e.length)return;const t=this.getActiveTerminal();if(t&&!t.state.fake&&t.refRealTerminal){const s=t.refRealTerminal.getRowsCols();for(const t of e)t.resize(s)}},resetTerminals(){this.replaceState(TerminalRefluxContainer_objectSpread(TerminalRefluxContainer_objectSpread({},this.getInitialState()),{},{workspaceReady:this.state.workspaceReady})),this.createInitialTerminal()},renderTerminal(e,t){return w.a.createElement(Ye.a,{key:t.id,ref:t.id,session:t,terminalId:t.id,fakeResponses:this.props.presenter.fake_responses,handleRealResponse:(e,t)=>{this.props.broadcast("input",e,t)},onFocus:qe.a.focus,onBlur:qe.a.blur,isActive:e===this.state.currentSession,hasCheckWork:this.props.presenter.hasCheckWork,shouldPreventCheckpointsOnTerminalCommand:this.props.presenter.shouldPreventCheckpointsOnTerminalCommand,workspaceReady:this.state.workspaceReady,fontSize:this.state.fontSize,hasFocus:this.state.hasFocus,checkpointRun:()=>Qe.a.run(),setFontSize:e=>{qe.a.setFontSize(e)},closeSession:e=>{qe.a.closeSession(e)}})},createNewTerminal(){qe.a.createSession("bash")},render(){const e=this.props.presenter,t=e.hasCheckWork,s=e.displayErrors;let r=[];const o=Object(ve.a)(this.state);if(o)r=w.a.createElement("div",{className:tt.a.terminalContainerSkeleton},w.a.createElement(ue.a,null));else if(this.state.sessions&&this.state.sessions.length>0)for(let e=0;e<this.state.sessions.length;e+=1){const t=this.state.sessions[e];r.push(this.renderTerminal(e,t))}else r=w.a.createElement(et.a,{busy:this.state.busy,hasCreatedSessionBefore:this.state.hasCreatedSessionBefore,onClick:()=>{qe.a.createSession("bash")}});const n=w.a.createElement(Je.a,{isLoading:o,isBusy:this.state.busy,canCreateSession:Xe.a.canCreateSession(),currentSessionIndex:this.state.currentSession,sessions:this.state.sessions.map((e=>({id:e.id,title:e.title}))),toggleFullscreen:this.props.helpers.toggleFullscreen,createNewTerminal:this.createNewTerminal,selectTerminalSession:qe.a.selectSession,closeTerminalSession:qe.a.closeSession}),i=w.a.createElement("div",{className:"fcn-component-footer"},w.a.createElement(ye.a,null,w.a.createElement(B.a,{className:tt.a.evaluateButton,square:!0,theme:"lantern",onClick:this.props.presenter.evaluateExercise,block:!0},"project"===this.props.presenter.contentItemType?W.components.terminal.refresh_browser:W.components.terminal.run_checkpoints)));return w.a.createElement("div",{className:"fcn-terminal-container fcn-terminal-container--with-header"},n,r,s&&w.a.createElement(A.a,null),t?i:null)}});var rt=s("4az4"),ot=s("44Ds"),nt=s.n(ot),it=s("bizM"),at=s("bQRv"),lt=s("/VKx"),ct=s("hsiM"),ht=s("9GW+"),dt=s("7mab"),pt=s("XVAG"),ut=s("xclP"),gt=s("S6PG"),mt=s("4sI8"),ft=s("hI/U");function WebBrowser(e){const t=e.urlBarRef,s=e.browserRef,r=e.bindBrowserListener,o=e.onUrlBarKeyDown,n=e.onUrlBarChange,i=e.onToggleFullscreen,a=e.onBack,l=e.onRefresh,c=e.onBrowserLoad,h=e.onBrowserError,d=e.onBrowserMessage,p=e.showErrors,u=e.isBlank,g=e.isReady,m=e.isLoading,f=e.src,b=e.refreshCount,y=e.displayUrl,v=void 0===y?"":y;if(!g)return w.a.createElement("div",{className:ft.a.browserSkeleton},w.a.createElement(gt.a,null));let C;return C=u?w.a.createElement(ut.a,{theme:"dark",componentName:"Web Browser",icon:ct.a}):w.a.createElement(mt.a,{src:f,onBrowserLoad:c,onBrowserMessage:d,onBrowserError:h,bindBrowserListener:r,refreshCount:b,ref:s}),w.a.createElement(lt.a,{grow:1,column:!0},w.a.createElement(lt.a,{className:ft.a.browserChrome},w.a.createElement(pt.a,{buttonClassName:ft.a.controlButton,className:ft.a.control,label:"Navigate back",onClick:a},w.a.createElement(ht.a,null)),w.a.createElement(pt.a,{buttonClassName:ft.a.controlButton,className:ft.a.control,label:"Navigate forward",onClick:l},w.a.createElement(dt.a,null)),w.a.createElement(lt.a,{center:!0,grow:1,className:ft.a.urlBarContainer},w.a.createElement("input",{"aria-label":"URL input",type:"text",className:ft.a.urlBar,value:v,ref:t,placeholder:"Type URL here",onKeyDown:o,onChange:n}),m&&w.a.createElement(X.a,null)),w.a.createElement(pt.a,{buttonClassName:ft.a.controlButton,className:ft.a.control,label:"Toggle fullscreen",onClick:i},w.a.createElement(P.a,null))),w.a.createElement(lt.a,{grow:1,className:ft.a.browserBody,column:!0},C),p&&w.a.createElement(A.a,{pinnedBottom:!0}))}const bt=nt()(((e,t)=>e),((e,t)=>t)),wt=f()({displayName:"WebBrowser",urlBarRef:Object(b.createRef)(),browserRef:Object(b.createRef)(),mixins:[j.a.connect(at.a),j.a.connect(Y.a,["workspaceReady","workspaceStatusType"])],getInitialState:()=>({urlBarValue:""}),getBrowser(){return this.browserRef},onUrlBarKeyDown(e){13===e.keyCode&&it.a.load(this.state.urlBarValue)},onUrlBarChange(e){this.setState({urlBarValue:e.target.value})},componentDidUpdate(e,t){!t.workspaceReady&&this.state.workspaceReady&&this.onHome()},isBlank(){const e=this.state.location;return!(void 0===e?{}:e).internalUrl||!Y.a.state.workspaceObject},onHome(){void 0!==this.props.presenter.display_url&&it.a.load(this.props.presenter.display_url)},bindBrowserListener:e=>it.a.sendMessage.listen(e),onBrowserMessage({data:e}){e&&(e.location&&it.a.push(e.location),it.a.receiveMessage(e))},onBrowserLoad(){at.a.state.onLoadCallback(),this.setState((e=>({urlBarValue:e.location.displayUrl})))},onBrowserError(){},onBack(){this.state.historyIndex>0&&it.a.navigateBack()},onRefresh(){it.a.refresh()},getSrc(){var e;const t=this.state,s=t.location,r=t.nonce,o=(null===(e=s.internalUrl)||void 0===e?void 0:e.toString())||"";return bt(o,r)},render(){const e=this.state,t=e.nonce,s=e.urlBarValue,r=this.props,o=r.presenter,n=r.helpers;return w.a.createElement(WebBrowser,{src:this.getSrc(),displayUrl:s,urlBarRef:this.urlBarRef,browserRef:this.browserRef,bindBrowserListener:this.bindBrowserListener,onBack:this.onBack,onRefresh:this.onRefresh,onBrowserMessage:this.onBrowserMessage,onBrowserLoad:this.onBrowserLoad,onBrowserError:this.onBrowserError,onUrlBarKeyDown:this.onUrlBarKeyDown,onUrlBarChange:this.onUrlBarChange,onToggleFullscreen:n.toggleFullscreen,showErrors:!!o.displayErrors,isLoading:this.state.loading,isReady:!Object(ve.a)(this.state),isBlank:this.isBlank(),refreshCount:t})}}),yt={ReadOnlyCodeEditor:Ge.b,PersistentCodeEditor:Ie,Image:S.a,Video:rt.a,Narrative:Ue.a,Terminal:st,OutputTerminal:Ke.a,WebBrowser:wt,Brief:ze.a,SQLPreview:$e,ExpoCodeEditor:Ie,ExpoPreview:wt};var vt=s("9i6/"),Ct=s("dLBa");const Et={PersistentCodeEditor:"CodeEditor",WebBrowser:"Preview",Brief:"Narrative",Image:"Visual",Video:"Visual",SQLPreview:"SQLPreview",ExpoCodeEditor:"CodeEditor",ExpoPreview:"Terminal"},kt=Ct.a.extend({initialize(){this.arrangements={},this.registerLayouts([{Narrative:"03"},{Narrative:"03",CodeEditor:"1245"},{Narrative:"03",CodeEditor:"14",ReadOnlyCodeEditor:"25"},{Narrative:"03",CodeEditor:"1",ReadOnlyCodeEditor:"2",Preview:"45"},{Narrative:"03",CodeEditor:"1",ReadOnlyCodeEditor:"2",OutputTerminal:"45"},{Narrative:"03",CodeEditor:"1",ReadOnlyCodeEditor:"2",Terminal:"45"},{Narrative:"03",Preview:"1245"},{Narrative:"03",OutputTerminal:"1245"},{Narrative:"03",Terminal:"1245"},{Narrative:"03",Visual:"1245"},{Narrative:"03",SQLPreview:"1245"},{Narrative:"03",CodeEditor:"14",Preview:"25"},{Narrative:"03",CodeEditor:"14",Visual:"25"},{Narrative:"03",CodeEditor:"14",OutputTerminal:"25"},{Narrative:"03",CodeEditor:"14",Terminal:"25"},{Narrative:"03",CodeEditor:"14",SQLPreview:"25"},{Narrative:"03",CodeEditor:"1",Preview:"25",OutputTerminal:"4"},{Narrative:"03",CodeEditor:"1",Preview:"25",Terminal:"4"},{Narrative:"03",CodeEditor:"1",Visual:"25",OutputTerminal:"4"},{Narrative:"03",CodeEditor:"1",Visual:"25",Terminal:"4"},{Narrative:"03",CodeEditor:"14",OutputTerminal:"2",Terminal:"5"},{Narrative:"03",Preview:"14",Visual:"25"},{Narrative:"03",Preview:"25",OutputTerminal:"14"},{Narrative:"03",Preview:"25",Terminal:"14"},{Narrative:"03",OutputTerminal:"45",Visual:"12"},{Narrative:"03",Terminal:"45",Visual:"12"}])},registerLayouts(e){e.forEach((e=>{this.registerLayout(e)}))},registerLayout(e){const t=Object.keys(e).sort().join("_"),s={};for(const t in e)s[t]={slots:`${e[t]}`,cols:this.determineColForSlots(e[t])};this.arrangements[t]=s},determineColForSlots(e){let t="";return/[03]/.test(e+="")&&(t+="1"),/[14]/.test(e)&&(t+="2"),/[25]/.test(e)&&(t+="3"),t},getArrangement(e){return this.arrangements[this.buildComponentName(e)]},arrangementAmong(e,t){const s=this.getArrangement(t);if(void 0===s)throw new Error(`Couldn't find layout for ${this.buildComponentName(t)}`);return s[Et[e.type]]||s[e.type]},buildComponentName:e=>Object.keys(e).map((e=>Et[e]||e)).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))).join("_")});class Cell{constructor(e,t,s,r){this.x=e,this.y=t,this.id=s,this.neighbors={},this.grid=r,this._right={value:e/r.width+1/r.width},this._bottom={value:t/r.height+1/r.height},0===e&&(this._left={value:0}),0===t&&(this._top={value:0})}left(){return 0===this.x?0:this.neighbors.left.right()}right(){return this._right.value}top(){return 0===this.y?0:this.neighbors.top.bottom()}bottom(){return this._bottom.value}soloEdges(){return{top:void 0===this.neighbors.top,right:void 0===this.neighbors.right,bottom:void 0===this.neighbors.bottom,left:void 0===this.neighbors.left}}set(e,t){switch(e){case"top":if(0===this.y)throw new Error("Cannot set 'top' on top-most cell");this.neighbors.top._bottom.value=t;break;case"right":if(this.x===this.grid.width-1)throw new Error("Cannot set 'right' on right-most cell");this._right.value=t;break;case"bottom":if(this.y===this.grid.height-1)throw new Error("Cannot set 'bottom' on bottom-most cell");this._bottom.value=t;break;case"left":if(0===this.x)throw new Error("Cannot set 'left' on left-most cell");this.neighbors.left._right.value=t}}}const Ot=.04,St=.06,Tt=["x","y"],_t={right:"x",bottom:"y",left:"x",top:"y"},xt={top:"bottom",right:"left",bottom:"top",left:"right"};class Posn{constructor(e,t){this.x=e,this.y=t}clone(){return new Posn(this.x,this.y)}gte(e){return this.x>=e.x&&this.y>=e.y}lte(e){return this.x<=e.x&&this.y<=e.y}}class Range{constructor(e,t){this.min=e,this.max=t,this.length=t-e+1}contains(e,t={}){const s=t.buffer||0;return this.min-s<=e&&this.max+s>=e}}class Slot_Slot{constructor(e,t){this.id=e,this.grid=t,this.cells={},this.lastEdgeSet={x:void 0,y:void 0}}registerCells(e){for(const t of e){if(this.cells[t.id]=t,void 0!==t.slot)throw new Error(`Can't register slot ${this.id}; cell ${t.id} already belongs to slot ${t.slot.id}!`);t.slot=this}this.calculateEdges(),this.mergePointers(),this.cacheNeighbors()}calculateEdges(){this.edgeCells={top:[],right:[],bottom:[],left:[]},this.edges={top:1,right:0,bottom:0,left:1};const e=Object.values(this.cells);for(const t of["top","right","bottom","left"])for(const s of e){const e=s[t]();0===this.edgeCells[t].length||e===this.edges[t]?(this.edgeCells[t].push(s),this.edges[t]=e):(("left"===t||"top"===t)&&e<this.edges[t]||("right"===t||"bottom"===t)&&e>this.edges[t])&&(this.edgeCells[t]=[s],this.edges[t]=e)}this.edgeExtents={};const t=this.sharedEdges();for(const e in t)if(t[e]){const t=this.edgeCells[e];this.edgeExtents[e]={x:new Range(Math.min(...t.map((e=>e.left()))),Math.max(...t.map((e=>e.right())))),y:new Range(Math.min(...t.map((e=>e.top()))),Math.max(...t.map((e=>e.bottom()))))}}}mergePointers(){for(const e in xt){const t=xt[e],s=this.edgeCells[e][0];if(!s[`_${e}`]){const r=s.neighbors[e];r&&(s[`_${e}`]=r[`_${t}`])}for(const r of this.edgeCells[e]){r[`_${e}`]=s[`_${e}`];const o=r.neighbors[e];o&&r[`_${e}`]&&(o[`_${t}`]=r[`_${e}`])}}}cacheNeighbors(){const e={top:[],right:[],bottom:[],left:[]};for(const t of Object.values(this.cells))t.neighbors.top&&t.top()===this.edges.top&&-1===e.top.indexOf(t.neighbors.top.slot)&&e.top.push(t.neighbors.top.slot),t.neighbors.right&&t.right()===this.edges.right&&-1===e.right.indexOf(t.neighbors.right.slot)&&e.right.push(t.neighbors.right.slot),t.neighbors.bottom&&t.bottom()===this.edges.bottom&&-1===e.bottom.indexOf(t.neighbors.bottom.slot)&&e.bottom.push(t.neighbors.bottom.slot),t.neighbors.left&&t.left()===this.edges.left&&-1===e.left.indexOf(t.neighbors.left.slot)&&e.left.push(t.neighbors.left.slot);this.neighbors=e}soloEdges(){return{top:this.edgeCells.top[0].soloEdges().top,right:this.edgeCells.right[0].soloEdges().right,bottom:this.edgeCells.bottom[0].soloEdges().bottom,left:this.edgeCells.left[0].soloEdges().left}}sharedEdges(){return{top:!this.edgeCells.top[0].soloEdges().top,right:!this.edgeCells.right[0].soloEdges().right,bottom:!this.edgeCells.bottom[0].soloEdges().bottom,left:!this.edgeCells.left[0].soloEdges().left}}top(){return this.edgeCells.top[0].top()}right(){return this.edgeCells.right[0].right()}bottom(){return this.edgeCells.bottom[0].bottom()}origin(){return new Posn(this.left(),this.top())}left(){return this.edgeCells.left[0].left()}width(){return this.right()-this.left()}roundedWidth(){return Math.round(100*this.width())/100}height(){return this.bottom()-this.top()}roundedHeight(){return Math.round(100*this.height())/100}coordExtent(){return{x:new Range(this.edgeCells.left[0].x,this.edgeCells.right[0].x),y:new Range(this.edgeCells.top[0].y,this.edgeCells.bottom[0].y)}}collapsed(e){switch(e){case"x":return this.roundedWidth()<=Ot;case"y":return this.roundedHeight()<=St;default:return this.collapsed("x")||this.collapsed("y")}}elgibileToSnap(e){switch(e){case"x":{const e=this.roundedWidth();return e>Ot&&e<=.1}default:{const e=this.roundedHeight();return e>St&&e<=.17}}}withinCollapseThreshold(e){switch(e){case"x":return this.roundedWidth()<=.1;default:return this.roundedHeight()<=.17}}slack(e){switch(e){case"x":return this.roundedWidth()-Ot;default:return this.roundedHeight()-St}}firstSlotWithSlackInDirection(e){const t=_t[e];return this.slack(t)>0?this:0===this.neighbors[e].length?null:this.neighbors[e][0].firstSlotWithSlackInDirection(e)}neighborWithSlackInDirection(e){switch(e){case"top":case"left":return this.firstSlotWithSlackInDirection(e);case"right":case"bottom":return this.neighbors[e][0].firstSlotWithSlackInDirection(e);default:return null}}firstDirectionWithSlack(e){for(const t of e)if(this.neighborWithSlackInDirection(t))return t;return null}set(e,t){for(const s of this.edgeCells[e])s.set(e,t);const s=_t[e];this.lastEdgeSet[s]=e;for(const t of this.neighbors[e]){t.lastEdgeSet[s]=xt[e],t.redistributeCells();const r=t.neighbors[xt[e]].filter((e=>e!==this));for(const t of r)t.lastEdgeSet[s]=e,t.redistributeCells()}this.redistributeCells()}push(e,t){const s=xt[e];if(0===this.neighbors[e].length)return!1;if("top"===e){return this.neighbors.top[0].push(s,-t)}if("left"===e){return this.neighbors.left[0].push(s,-t)}const r=_t[e];let o;if(o=t>0?this.neighborWithSlackInDirection(e):this.neighborWithSlackInDirection(s),!o)return!1;const n=t<0;t=Math.min(Math.abs(t),o.slack(r)),n&&(t=-t),this.set(e,this[e]()+t),this.enforceMinimumDimensions(e);const i=this.neighbors[t>0?e:s];if(i)for(const e of i)e.enforceMinimumDimensions(s);return!0}redistributeCells(){const e=Object.values(this.cells),t=this.coordExtent();for(const s of e){if(t.x.length>1){const e=(s.x+1-t.x.min)/t.x.length;s.neighbors.right&&s.set("right",this.left()+e*this.width())}if(t.y.length>1){const e=(s.y+1-t.y.min)/t.y.length;s.neighbors.bottom&&s.set("bottom",this.top()+e*this.height())}}}fullscreen(){let e=!1;for(const t in _t)for(;this.push(t,1);)e=!0;return e}enforceMinimumDimensions(e){const t=this.width(),s=this.height();switch(e){case"left":t<Ot&&(this.neighbors.right.length?this.set("right",this.left()+Ot):this.set("left",this.right()-Ot));break;case"right":t<Ot&&(this.neighbors.left.length?this.set("left",this.right()-Ot):this.set("right",this.left()+Ot));break;case"top":s<St&&(this.neighbors.bottom.length?this.set("bottom",this.top()+St):this.set("top",this.bottom()-St));break;default:s<St&&(this.neighbors.top.length?this.set("top",this.bottom()-St):this.set("bottom",this.top()+St))}}}class Grid_Grid{constructor(e,t){this.width=e,this.height=t,this.cells=[],this.slots={};for(let s=0;s<t;s+=1){const t=[];this.cells[s]=t;for(let r=0;r<e;r+=1){const o=new Cell(r,s,s*e+r,this);t[r]=o}}for(let s=0;s<t;s+=1)for(let r=0;r<e;r+=1){const o=this.getCellByCoords(r,s);s>0&&(o.neighbors.top=this.getCellByCoords(r,s-1)),r<e-1&&(o.neighbors.right=this.getCellByCoords(r+1,s)),s<t-1&&(o.neighbors.bottom=this.getCellByCoords(r,s+1)),r>0&&(o.neighbors.left=this.getCellByCoords(r-1,s))}}registerSlot(e){const t=new Slot_Slot(e,this);this.slots[e]=t;const s=e.split("").map((e=>this.getCellById(parseInt(e,10))));t.registerCells(s),this.slotsList=Object.values(this.slots);for(const e of this.slotsList)e.cacheNeighbors()}getSlotById(e){return this.slots[e]}getCellByCoords(e,t){return this.cells[t][e]}getCellById(e){const t=e%this.width,s=Math.floor(e/this.width);return this.cells[s][t]}registerDOMNode(e){this.DOMNode=e}DOMNodeRect(){return this.DOMNode.getBoundingClientRect()}percentageToPx(e,t){if(0===t)return 0;switch(e){case"x":return this.DOMNodeRect().width*t;default:return this.DOMNodeRect().height*t}}pxToPercentage(e,t){if(0===t)return 0;switch(e){case"x":return t/this.DOMNodeRect().width;default:return t/this.DOMNodeRect().height}}gutterUnderPosn(e){const t=this.DOMNodeRect(),s=new Posn(e.x-t.left,e.y-t.top);for(const e of this.slotsList)for(const t in e.edgeExtents)switch(t){case"right":{const r=this.percentageToPx("x",e[t]()),o=this.percentageToPx("y",e.edgeExtents[t].y.min),n=this.percentageToPx("y",e.edgeExtents[t].y.max);if(Math.abs(s.x-r)<7&&s.y>=o&&s.y<=n)return{edge:t,slot:e};break}case"bottom":{const r=this.percentageToPx("y",e[t]()),o=this.percentageToPx("x",e.edgeExtents[t].x.min),n=this.percentageToPx("x",e.edgeExtents[t].x.max);if(Math.abs(s.y-r)<7&&s.x>=o&&s.x<=n)return{edge:t,slot:e};break}}}recalculateEdges(){for(const e of this.slotsList)e.calculateEdges()}getSlotsWaitingToCollapse(e){return this.slotsList.filter((t=>t.elgibileToSnap(e)))}expandSlot(e){const t=this.getSlotById(e),s=t.origin(),r=t.coordExtent();for(const e of Tt){const s=t.lastEdgeSet[e],o=t.firstDirectionWithSlack([s,xt[s]]);if(!o)continue;let n;if(t.withinCollapseThreshold(e))switch(e){case"x":n=r[e].length/this.width,t.push(o,n-t.width());break;default:n=r[e].length/this.height,t.push(o,n-t.height())}}this.snapSlots(s)}expandSlotInDirection(e,t){const s=this.getSlotById(e),r=s.neighbors[t];let o;r.length>0&&(o=r[0].slack(_t[t]),s.push(t,o))}toggleFullscreenSlot(e){if(!this.slots[e].fullscreen()){const e=1/this.width,t=1/this.height;for(let s=0;s<this.height;s+=1)for(let r=0;r<this.width;r+=1){const o=this.cells[s][r];o._right.value=(r+1)*e,o._bottom.value=(s+1)*t}return!1}return!0}fullscreenSlot(){const e=this.slotsList.filter((e=>!(e.withinCollapseThreshold("x")||e.withinCollapseThreshold("y"))));return 1===e.length?e[0]:null}snapSlots(e){this.recalculateEdges();const t=[],s={};for(const r of["x","y"]){const o=this.getSlotsWaitingToCollapse(r);for(const n of o){let o;const i=-n.slack(r);if(o=s[r]?s[r]:n.origin().lte(e)?{x:"right",y:"bottom"}[r]:{x:"left",y:"top"}[r],(0===n.neighbors[o].length||t.indexOf(n.neighbors[o][0].id)>-1)&&(o=xt[o]),0===n.neighbors[o].length||t.indexOf(n.neighbors[o][0].id)>-1)return;s[r]=o,n.push(o,i),t.push(n.id)}}}}let jt=null,Bt=null;var Pt={save(){if(jt=document.activeElement,jt&&window.getSelection){const e=window.getSelection();Bt="Range"===e.type?e.getRangeAt(0):null}},restore(){if(jt&&(jt.focus(),Bt&&window.getSelection)){const e=window.getSelection();e.rangeCount>0&&e.removeAllRanges(),e.addRange(Bt)}}},Nt={componentDidMount(){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},componentWillUnmount(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},onMouseDown(e){0===e.button&&this.handleMouseDown&&this.handleMouseDown(e)},onMouseUp(e){if(this.handleMouseUp){if(void 0!==e._dispatchIDs)return;this.handleMouseUp(e)}},onMouseMove(e){if(this.handleMouseMove){if(void 0!==e._dispatchIDs)return;this.handleMouseMove(e,this.state.didMouseMove),this.state.didMouseMove=!0}}};function ComponentGrid_ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function ComponentGrid_objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ComponentGrid_ownKeys(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ComponentGrid_ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const Rt={Terminal:"terminal",OutputTerminal:"terminal",PersistentCodeEditor:"editor",ReadOnlyCodeEditor:"editor",Image:"image",Narrative:"learn",WebBrowser:"browser"},Mt=f()({displayName:"ComponentGrid",mixins:[Nt],getInitialState(){const e=new Grid_Grid(3,2),t={fullscreenSlot:void 0,config:new kt,cursor:"auto",grid:e,slotArrangements:{},hasTrackedDragging:!1},s=this.props.components;for(const r of Object.keys(s)){const o=t.config.arrangementAmong(s[r],s);e.registerSlot(o.slots)}for(let t=0;t<e.width*e.height;t+=1)e.getCellById(t).slot||e.registerSlot(`${t}`);return void 0!==this.props.gridSetup&&this.props.gridSetup(e),t},componentDidMount(){this.state.grid.registerDOMNode(v.a.findDOMNode(this))},UNSAFE_componentWillUpdate(e,t){t.grid&&(t.fullscreenSlot=t.grid.fullscreenSlot())},componentDidUpdate(){this.state.resizing&&k.a.resized(),this.state.resizing=!1},shouldPreventCheckpointsOnTerminalCommand(){const e=this.props.components;return!0===c()(e,"Terminal.prevent_checkpoint_run")},hasCheckWork(){const e=this.props,t=e.contentItemType,s=e.components;return!("project"===t&&!Object.keys(s).includes("WebBrowser"))&&(this.shouldPreventCheckpointsOnTerminalCommand()&&!0===c()(s,"PersistentCodeEditor.no_run_button"))},evaluateExercise(){return this.props.checkpointsRunning?Promise.resolve():this.hasCheckWork()?O.a.checkWork():O.a.saveFilesAndCheckWork()},selectComponentForError(){const e=this.props.components,t=["PersistentCodeEditor","Terminal","WebBrowser"];for(const s of t)if(e[s])return s;const s=Object.keys(e).filter((e=>"Narrative"!==e));return s.length>0?s[0]:null},buildComponents(){const e=this.props.components,t={};for(const s of Object.keys(e)){const r=yt[e[s].type],o=this.state.config.arrangementAmong(e[s],e),n=this.props.helpers.componentShouldBeDisabled(s);this.state.slotArrangements[s]=o.slots;const i=this.toggleFullscreenSlot.bind(this,o.slots),l=w.a.createElement(FullScreenControls,{toggleFullscreen:i,isFullscreen:!!this.state.fullscreenSlot}),c=ComponentGrid_objectSpread(ComponentGrid_objectSpread({},this.props.modifiers),{},{disabled:n,fullscreen:o.slots===this.state.fullscreenSlot,dragging:this.state.dragging});let h={fullscreenButton:l,evaluateExercise:this.evaluateExercise,hasCheckWork:this.hasCheckWork(),shouldPreventCheckpointsOnTerminalCommand:this.shouldPreventCheckpointsOnTerminalCommand(),contentItemType:this.props.contentItemType};a()(h,this.props.presenter);const d=this.selectComponentForError();h.displayErrors=d===s,h=a()({},e[s],h);const p={arrangement:o,wall:this.props.presenter.wall,geometry:this.state.grid.slots[o.slots]},u={toggleFullscreen:this.toggleFullscreenSlot.bind(this,o.slots)},g={constructor:r,presenter:h,name:s,icon:Rt[s]},m=w.a.createElement(vt.a,{deferred:-1===["Brief","Narrative"].indexOf(s),locations:o.slots,component:g,slot:p,modifiers:c,helpers:u,adapter:this.props.adapter,user:this.props.user,expandSlot:this.expandSlot,key:`slot:${s}`});for(const e of o.slots.split(""))t[e]=m}return d()(Object.keys(t).sort().map((e=>t[e])))},expandSlot(e){this.state.grid.expandSlot(e),this.setState((e=>({grid:e.grid,resizing:!0})))},expandSlotByName(e){const t=this.state.slotArrangements[e];if(!t)throw new Error(`No arrangement for ${e}`);this.state.grid.expandSlot(t),this.setState((e=>({grid:e.grid,resizing:!0})))},toggleFullscreenSlot(e){this.state.grid.toggleFullscreenSlot(e),Object(E.c)({target:"platformFullscreen"}),this.setState((e=>({grid:e.grid,resizing:!0})))},hasDOMNode(){return Boolean(this.state.grid.DOMNode)},handleMouseMove(e,t){if(!this.hasDOMNode())return;const s=this.getPosns(e).pagePosn;if(this.state.dragging){if(e.preventDefault(),this.props.adapter.trigger("interface:resizing"),this.state.hasTrackedDragging||(Object(E.c)({target:"platformDragHandle"}),this.setState((()=>({hasTrackedDragging:!0})))),t){let e;const t=this.state.focusedGutter.edge;if("right"===t){const t=this.state.grid.DOMNodeRect().left+this.state.grid.percentageToPx("x",this.state.focusedGutter.slot.right());e=s.x-t,this.state.focusedGutter.slot.push("right",this.state.grid.pxToPercentage("x",e)),this.setState((e=>({grid:e.grid})))}else if("bottom"===t){const t=this.state.grid.DOMNodeRect().top+this.state.grid.percentageToPx("y",this.state.focusedGutter.slot.bottom());e=s.y-t,this.state.focusedGutter.slot.push("bottom",this.state.grid.pxToPercentage("y",e)),this.setState((e=>({grid:e.grid})))}}}else{const e=this.state.grid.gutterUnderPosn(s);let t;t=void 0!==e?{right:"ew-resize",bottom:"ns-resize"}[e.edge]:"auto",Pt.save(),this.state.focusedGutter===e&&this.state.cursor===t||this.setState({focusedGutter:e,cursor:t})}},handleMouseDown(){this.state.focusedGutter&&this.setState({dragging:!0})},handleMouseUp(e){e.target instanceof HTMLAnchorElement||(this.state.dragging&&(this.state.grid.snapSlots(this.state.focusedGutter.slot.origin()),e.stopPropagation(),e.preventDefault(),n()(Pt.restore)),this.setState((e=>({grid:e.grid,dragging:!1,resizing:e.dragging}))))},getPosns(e){if(!this.hasDOMNode())return{};const t=this.state.grid.DOMNodeRect();return{offsetPosn:new Posn(e.pageX-t.left,e.offsetY-t.top),pagePosn:new Posn(e.pageX,e.pageY)}},render(){const e=g()({"fcn-grid":!0,"fcn-grid--dragging":!!this.state.dragging}),t={cursor:this.state.cursor};return w.a.createElement("div",{className:e,onMouseMove:this.onMouseMove,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,style:t},w.a.createElement(p.a,{as:"h1"},this.props.title),this.buildComponents(),this.props.presenter.wall)}});t.a=Object(C.connect)((e=>({checkpointsRunning:Object(_.h)(e)})),null,null,{forwardRef:!0})(Mt)},ScvY:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var r=s("BzM2"),o=s("MKeS"),n=s("fhzG"),i=s.n(n),a=s("q1tI"),l=s.n(a),c=s("071C"),h=s("/9uS"),d=s("ydTQ");const p=Object(o.a)({resolved:{},chunkName:()=>"OutputTerminal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!s.m[t]},importAsync:()=>Promise.all([s.e(268),s.e(518),s.e(56),s.e(364),s.e(267),s.e(381)]).then(s.bind(null,"Wt+T")),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return s(t)},resolve(){return"Wt+T"}}),u=i()({displayName:"OutputTerminalRefluxContainer",mixins:[r.a.connect(h.a,["output","awaitingInput"]),r.a.connect(d.a,["workspaceStatusType","workspaceReady"])],handleInput(e){c.a.input(e)},render(){return l.a.createElement(p,{awaitingInput:this.state.awaitingInput,handleInput:this.handleInput,output:this.state.output,workspaceReady:this.state.workspaceReady,workspaceStatusType:this.state.workspaceStatusType})}})},Z6NK:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("eikI");const o=[{componentShouldBeDisabled(e){var t;switch(e){case"Terminal":case"OutputTerminal":case"WebBrowser":case"PersistentCodeEditor":case"ReadOnlyCodeEditor":if(!this.state.workspaceReady)return!0}return!!(null!==(t=this.isExerciseLocked)&&void 0!==t&&t.call(this)||r.a.isAnon())}}]},bf6c:function(e,t,s){"use strict";s.d(t,"a",(function(){return setupWorkspace}));var r=s("rePB"),o=s("bizM"),n=s("t2YD"),i=s("NZ0w");function ownKeys(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(s),!0).forEach((function(t){Object(r.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const setupWorkspace=async({content:e,isAnonymous:t,userId:s})=>{if(t)return;const r=_objectSpread(_objectSpread({},e.workspace),{},{einConfig:e.ein_config,user_id:s});e.components.PersistentCodeEditor?n.a.publishFilenames(e.components.PersistentCodeEditor.files):n.a.publishFilenames([]),await i.a.setWorkspace(r),await o.a.clearHistory(),e.components.WebBrowser&&e.components.WebBrowser.display_url&&await o.a.load(e.components.WebBrowser.display_url)}},dLBa:function(e,t,s){"use strict";s.d(t,"a",(function(){return Controller}));var r=s("OFL0"),o=s.n(r),n=s("zdiy"),i=s.n(n),a=s("w/QP"),l=s.n(a),c=s("gB9P"),h=s.n(c);function Controller(){this.initialize.apply(this,arguments)}Controller.extend=function(e,t){const s=this;let r;return r=e&&o()(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i()(r,s,t),r.prototype=l()(s.prototype,e),r.prototype.constructor=r,r.__super__=s.prototype,r},Controller.prototype=h.a.mixin({})},zqu8:function(e,t,s){"use strict";s.d(t,"a",(function(){return LegacyLearningEnvironment}));var r=s("rePB"),o=s("DzJC"),n=s.n(o),i=s("q1tI"),a=s.n(i),l=s("F6+0"),c=s("NZ0w"),h=s("lkI2");class LegacyLearningEnvironment extends a.a.Component{constructor(...e){super(...e),Object(r.a)(this,"resizeCallback",n()((()=>{l.a.resized()}))),Object(r.a)(this,"onlineCallback",n()((()=>{Object(h.a)("info","Reconnected from offline state"),c.a.setOfflineState(!1)}))),Object(r.a)(this,"offlineCallback",n()((()=>{c.a.setOfflineState(!0)})))}componentDidMount(){window.addEventListener("resize",this.resizeCallback),window.addEventListener("online",this.onlineCallback),window.addEventListener("offline",this.offlineCallback)}componentWillUnmount(){window.removeEventListener("resize",this.resizeCallback),window.removeEventListener("online",this.onlineCallback),window.removeEventListener("offline",this.offlineCallback)}render(){return a.a.createElement(a.a.Fragment,null,this.props.children)}}}}]);
//# sourceMappingURL=431.f17d099a9283fd9670f4.chunk.js.map